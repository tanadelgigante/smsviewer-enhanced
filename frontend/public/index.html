<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SMS Viewer</title>
<script>
    // Fetch the API URL from the server at runtime
    fetch('/config')
        .then(response => response.json())
        .then(data => {
            window.API_URL = data.API_URL || "/get-latest-sms";
        })
        .catch(error => {
            console.error('Error fetching API URL:', error);
            window.API_URL = "/get-latest-sms";  // Fallback
        });
</script>
<link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script defer src="script.js"></script>
<style>
#contact-list {
    max-height: calc(100vh - 200px);
    overflow-y: auto;
}

#chat-window {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
    padding: 1rem;
    background-color: #f8f9fa;
}

#upload-area {
    background-color: #e9ecef;
    border: 2px dashed #adb5bd;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

#upload-area.hover {
    background-color: #dee2e6;
}
</style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center">SMS Viewer Enhanced</h1>
        <div id="upload-area" class="p-4 text-center rounded mb-4">
            <h5>
                <i class="fa-solid fa-cloud-upload-alt"></i> Drag & Drop your SMS
                XML file here
            </h5>
            <p>or click to upload</p>
            <input type="file" id="file-input" accept=".xml"
                style="display: none;">
        </div>
        <div class="row">
            <div class="col-md-3">
                <input type="text" id="contact-search" class="form-control mb-2"
                    placeholder="Search contacts...">
                <ul id="contact-list" class="list-group">
                    <!-- Contacts will be populated here -->
                </ul>
            </div>
            <div class="col-md-9">
                <div id="chat-window" class="border p-3">
                    <p class="text-muted text-center">Select a contact to view
                        messages</p>
                </div>
            </div>
        </div>
    </div>
    <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
